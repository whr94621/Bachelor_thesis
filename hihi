All2Gauss相比于其他向量表示模型的最大不同在于，它自然引进了KL散度这一非对称的度量，能够学习一些通过偏序关系形成的层次结构，比如上下位关系、语义的继承关系（entailment）等。ICLR15的论文中，作者指出了该模型具有学习这种层次结构的能力，然而本文则想通过上下位词的学习试图说明原论文的模型学习的效果并不理想，并给出了改进方式和二者的对比实验。

首先解释一下什么是上下位词（hypernym-hyponym）关系。在语言学中，下位词（hyponym）相对于上位词（hypernym），是一种is-a的关系。例如“狗是一种哺乳动物”、“西瓜是一种水果”，“狗”、“西瓜”相对于“哺乳动物”、“水果”是下位词，反之则是上位词。上下位词关系的引入对诸如问答系统、自然语言推断（natural language inference）等任务的效果具有很好的提升。

在ICLR15的原文中，作者采用KL散度的能量函数，将具有上下位关系的词对作为正样本，并通过分别对上位词和下位词位置进行负采样得到的词对作为负样本，采用和词表示学习同样的方式进行训练。其损失函数如下：

Loss(v_{hyper}, v_{hypo}) = max\{ \var..

从该损失函数可以看出，存在上下位关系的词对具有较大的KL散度值（本质上是增大上位词的协方差矩阵，减小下位词的协方差矩阵），并且与负样本存在一个边界，这个边界可以通过交叉验证（cross-validation）等手段获得。然而不得不指出的是，这种方式存在这如下的问题：

(1)负采样的方式不合适。(18.)曾提指出在对知识图谱三元组的两个本体进行负采样时，要使得进行采样的位置尽可能的减少会产生假负样本（false-negative）的情况。这同样适用于对于上下位词的采样。举一个例子：对于上下位词对（mammal.n.01，dog.n.01）对于下位词"dog.n.01"进行采样时，由于其他的哺乳动物都是其下位词，有相当的概率得到的并非负样本。这种采样不正确的情况，会使得处于上位词位置的表示存在过拟合现象（即对任意的词都会判定为存在上下位关系）。从后面的实验部分可以看出，原模型的召回率（Recall）非常高。

(2)损失函数设计的并不合理。实际上，对于一个词对$(w_a,w_b)$而言存在着三种上下位情况（上下位关系记为$\preceq$，本文一下沿用该记号)：$w_a \preceq w_b$、$w_b \preceq w_a$、$w_a$和$w_b$无关系。对于第一种情况的判断，由于KL散度的性质，只要存在$D_KL(v_a || v_b) \preceq \varepsilon$即可，然而后两中情况的判断，还需要考虑$D_KL(v_b || v_a)$与$\varepsilon$的关系。然而对于原文章中的损失函数而言，单纯的增大正样本和负采样样本之间的边际，有时会造成$D_KL(v_hyper||v_neg)$或$D_KL(v_neg||v_hypo)$，使得他们产生相反的上下位词的关系。从后面的实验中可以看出，这会造成模型的精准度（Precision）迅速下降。

为了解决这两个问题，本文同样提出了两种应对方法：

a) 只对上位词位置进行负采样。考虑到这里训练的负样本是不构成上下位词关系的词对，且上下位词呈现的是一种树状的层次结构，下位词的上位词是唯一确定的（相对词义而言，多义词会存在多个）。

b) 考虑新的损失函数：

在沿用原模型损失函数的基础上，我们新添加了一个对负样本的正则项和边际，来避免前面b)中出现的问题。这个损失函数同样反映了我们新的判别标准：对于词对$(w_a,w_b)$当$D_{KL}(w_a||w_b)-D_{KL}(w_b||w_a) > \theta$时，认为$w_a \preceq w_b$；当$|D_{KL}(w_a||w_b)-D_{KL}(w_b||w_a) < \theta|$时认为$w_a$和$w_b$无上下位关系。这里的$\theta$同样需要通过交叉验证来选取，不过一般情况下会大于训练时的$\varepsilon$，这一点在后面的实验中会进行讨论。

关于上下位词关系最常用的语料库是WordNet。WordNet是一个英语词汇数据库（lexical database）。区别与常见的词典，WordNet将所有的单词聚成一个同义词集合（synsets）来表示一个共同的语义。为了方便的获得训练集和测试集，本文采用了NLTK的wordNet Interface，获得了所有上下位词关系的传递闭包（transitive closures），共计698587个正样本词对，按一定比例获得训练集和测试集中的正样本，负样本则按照负采样的方法生成。我们这里不对分布的具体选取做出讨论，因此选取均值的维数为50，协方差矩阵为对角型矩阵，迭代次数会在随后的结果中指明，负采样个数统一设定为5。

实验中



























